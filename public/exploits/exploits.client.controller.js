/**
 * Created by dongyin on 1/27/16.
 */
exploits.controller('exploitsController',function($scope,$http,$timeout){

    $scope.dbtype = "ALL" ;
    $scope.keywords = "" ;
    $scope.exploits = "empty";
    $scope.searchExploits = function(){
        if($scope.keywords == ""){
            alert("Can't be null");
        }else {
            var source = "";
            if ($scope.dbtype == "EDB") {
                source = "exploit-db.com";
            } else if ($scope.dbtype == "PSS") {
                source = "packetstormsecurity.com";
            }else if ($scope.dbtype == "ALL"){
                source = "empty";
            }
            else {
                source = "empty";
            }
            $timeout(function(){
            $http.get('/data/exploits/search/' + source + "/" + $scope.keywords).then(function (data) {
                $scope.exploits = data.data;
            });
            },1500);
        }
    };

    $http.get('/data/exploits').then(function(data){
        $scope.exploits = data.data;
        $scope.total = data.data.length;
    });
});